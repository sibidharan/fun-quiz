/* ============================================
   ENVIRONMENT THEME - PREMIUM CINEMATIC
   Lush forest sanctuary with magical nature
   Fresh greens, sky blues, golden sunlight
   ============================================ */

/* === LAYERED BACKGROUND WITH GRADIENTS === */
.theme-environment .scene-background {
    background:
        /* Atmospheric depth layers */
        radial-gradient(ellipse at 50% 0%, rgba(255, 255, 255, 0.25) 0%, transparent 40%),
        radial-gradient(ellipse at 20% 100%, rgba(76, 175, 80, 0.2) 0%, transparent 35%),
        radial-gradient(ellipse at 80% 80%, rgba(129, 199, 132, 0.18) 0%, transparent 30%),
        /* Nature gradient - sky to forest floor */
        linear-gradient(180deg,
            #01579B 0%,
            #0277BD 5%,
            #0288D1 10%,
            #039BE5 15%,
            #03A9F4 20%,
            #29B6F6 25%,
            #4FC3F7 30%,
            #81D4FA 35%,
            #B3E5FC 40%,
            #DCEDC8 45%,
            #C5E1A5 50%,
            #AED581 55%,
            #9CCC65 60%,
            #8BC34A 65%,
            #7CB342 70%,
            #689F38 75%,
            #558B2F 80%,
            #33691E 85%,
            #1B5E20 92%,
            #0D3C14 100%);
    overflow: hidden;
    position: relative;
}

/* === LARGE TREE (MAJESTIC OAK) === */
.theme-environment .elem-1 {
    position: absolute;
    bottom: 5%;
    left: 8%;
    width: 50px;
    height: 200px;
    z-index: 10;
    pointer-events: none;
}

/* Tree trunk with texture */
.theme-environment .elem-1::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    height: 140px;
    background:
        repeating-linear-gradient(90deg,
            transparent 0px,
            transparent 2px,
            rgba(78, 52, 46, 0.3) 2px,
            rgba(78, 52, 46, 0.3) 4px) 0 0 / 100% 15px,
        linear-gradient(90deg,
            #5D4037 0%,
            #6D4C41 15%,
            #795548 30%,
            #8D6E63 50%,
            #795548 70%,
            #6D4C41 85%,
            #5D4037 100%);
    border-radius: 15px 15px 8px 8px;
    box-shadow:
        inset -8px 0 15px rgba(0, 0, 0, 0.3),
        inset 5px 0 10px rgba(255, 255, 255, 0.1),
        5px 10px 25px rgba(0, 0, 0, 0.4);
    animation: env-tree-sway 9.5s ease-in-out infinite;
}

/* Tree crown (layered foliage) */
.theme-environment .elem-1::after {
    content: '';
    position: absolute;
    bottom: 130px;
    left: 50%;
    transform: translateX(-50%);
    width: 200px;
    height: 180px;
    background:
        /* Inner dark leaves */
        radial-gradient(ellipse at 50% 75%, #1B5E20 0%, #1B5E20 28%, transparent 29%),
        radial-gradient(ellipse at 30% 65%, #2E7D32 0%, #2E7D32 32%, transparent 33%),
        radial-gradient(ellipse at 70% 60%, #388E3C 0%, #388E3C 30%, transparent 31%),
        /* Mid leaves */
        radial-gradient(ellipse at 25% 50%, #43A047 0%, #43A047 35%, transparent 36%),
        radial-gradient(ellipse at 75% 45%, #4CAF50 0%, #4CAF50 33%, transparent 34%),
        radial-gradient(ellipse at 50% 40%, #66BB6A 0%, #66BB6A 38%, transparent 39%),
        /* Outer bright leaves */
        radial-gradient(ellipse at 20% 30%, #81C784 0%, #81C784 30%, transparent 31%),
        radial-gradient(ellipse at 80% 28%, #A5D6A7 0%, #A5D6A7 28%, transparent 29%),
        radial-gradient(ellipse at 50% 18%, #C8E6C9 0%, #C8E6C9 32%, transparent 33%);
    filter: drop-shadow(0 12px 30px rgba(0, 0, 0, 0.3));
    animation: env-leaves-breathe 7.2s ease-in-out infinite;
}

@keyframes env-tree-sway {
    0%, 100% { transform: translateX(-50%) rotate(0deg); }
    25% { transform: translateX(-50%) rotate(1.8deg); }
    50% { transform: translateX(-50%) rotate(0deg); }
    75% { transform: translateX(-50%) rotate(-1.8deg); }
}

@keyframes env-leaves-breathe {
    0%, 100% { transform: translateX(-50%) scale(1) rotate(0deg); }
    50% { transform: translateX(-50%) scale(1.05) rotate(1deg); }
}

/* === SWAYING LEAVES (FALLING) === */
.theme-environment .elem-2 {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: 18;
    pointer-events: none;
}

.theme-environment .elem-2::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background:
        radial-gradient(ellipse at 8% 5%, rgba(129, 199, 132, 0.85) 0%, rgba(129, 199, 132, 0.85) 30%, transparent 31%) 0 0 / 12px 18px,
        radial-gradient(ellipse at 22% 12%, rgba(102, 187, 106, 0.8) 0%, rgba(102, 187, 106, 0.8) 32%, transparent 33%) 0 0 / 14px 20px,
        radial-gradient(ellipse at 38% 8%, rgba(76, 175, 80, 0.9) 0%, rgba(76, 175, 80, 0.9) 28%, transparent 29%) 0 0 / 13px 19px,
        radial-gradient(ellipse at 54% 15%, rgba(129, 199, 132, 0.75) 0%, rgba(129, 199, 132, 0.75) 31%, transparent 32%) 0 0 / 11px 17px,
        radial-gradient(ellipse at 68% 10%, rgba(102, 187, 106, 0.85) 0%, rgba(102, 187, 106, 0.85) 29%, transparent 30%) 0 0 / 13px 18px,
        radial-gradient(ellipse at 82% 18%, rgba(76, 175, 80, 0.8) 0%, rgba(76, 175, 80, 0.8) 33%, transparent 34%) 0 0 / 14px 21px,
        radial-gradient(ellipse at 92% 6%, rgba(129, 199, 132, 0.9) 0%, rgba(129, 199, 132, 0.9) 30%, transparent 31%) 0 0 / 12px 19px;
    animation: env-leaves-fall 28s linear infinite;
}

@keyframes env-leaves-fall {
    0% { transform: translateY(-5%); opacity: 0; }
    10% { opacity: 0.8; }
    90% { opacity: 0.8; }
    100% { transform: translateY(105vh); opacity: 0; }
}

/* === BUTTERFLIES (3 DIFFERENT) === */
.theme-environment .elem-3 {
    position: absolute;
    bottom: 45%;
    left: 35%;
    width: 18px;
    height: 18px;
    z-index: 20;
    pointer-events: none;
    animation: env-butterfly-path-1 18.5s ease-in-out infinite;
}

/* Butterfly body */
.theme-environment .elem-3 {
    background: linear-gradient(180deg, #4E342E 0%, #5D4037 100%);
    border-radius: 10px;
}

/* Left wings */
.theme-environment .elem-3::before {
    content: '';
    position: absolute;
    width: 16px;
    height: 14px;
    background:
        radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.4) 0%, transparent 8px),
        radial-gradient(circle at 40% 40%, #EC407A 0%, #EC407A 40%, transparent 41%),
        linear-gradient(125deg, #E91E63, #F48FB1);
    border-radius: 60% 60% 25% 60%;
    left: -9px;
    top: 2px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    animation: env-wing-flutter-left 0.15s ease-in-out infinite alternate;
}

/* Right wings */
.theme-environment .elem-3::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 14px;
    background:
        radial-gradient(circle at 65% 35%, rgba(255, 255, 255, 0.4) 0%, transparent 8px),
        radial-gradient(circle at 60% 40%, #EC407A 0%, #EC407A 40%, transparent 41%),
        linear-gradient(235deg, #E91E63, #F48FB1);
    border-radius: 60% 60% 60% 25%;
    right: -9px;
    top: 2px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    animation: env-wing-flutter-right 0.15s ease-in-out infinite alternate;
}

/* Butterfly 2 */
.theme-environment .butterfly-2 {
    position: absolute;
    bottom: 60%;
    left: 65%;
    width: 16px;
    height: 16px;
    background: linear-gradient(180deg, #4E342E 0%, #5D4037 100%);
    border-radius: 9px;
    z-index: 21;
    pointer-events: none;
    animation: env-butterfly-path-2 15.3s ease-in-out infinite 3s;
}

.theme-environment .butterfly-2::before {
    content: '';
    position: absolute;
    width: 14px;
    height: 12px;
    background:
        radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.35) 0%, transparent 7px),
        linear-gradient(125deg, #FF9800, #FFB74D);
    border-radius: 60% 60% 25% 60%;
    left: -8px;
    top: 2px;
    animation: env-wing-flutter-left 0.18s ease-in-out infinite alternate;
}

.theme-environment .butterfly-2::after {
    content: '';
    position: absolute;
    width: 14px;
    height: 12px;
    background:
        radial-gradient(circle at 65% 35%, rgba(255, 255, 255, 0.35) 0%, transparent 7px),
        linear-gradient(235deg, #FF9800, #FFB74D);
    border-radius: 60% 60% 60% 25%;
    right: -8px;
    top: 2px;
    animation: env-wing-flutter-right 0.18s ease-in-out infinite alternate;
}

/* Butterfly 3 */
.theme-environment .butterfly-3 {
    position: absolute;
    bottom: 35%;
    left: 80%;
    width: 17px;
    height: 17px;
    background: linear-gradient(180deg, #4E342E 0%, #5D4037 100%);
    border-radius: 9px;
    z-index: 19;
    pointer-events: none;
    animation: env-butterfly-path-3 16.8s ease-in-out infinite 6s;
}

.theme-environment .butterfly-3::before {
    content: '';
    position: absolute;
    width: 15px;
    height: 13px;
    background:
        radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.4) 0%, transparent 7px),
        linear-gradient(125deg, #9C27B0, #CE93D8);
    border-radius: 60% 60% 25% 60%;
    left: -8px;
    top: 2px;
    animation: env-wing-flutter-left 0.16s ease-in-out infinite alternate;
}

.theme-environment .butterfly-3::after {
    content: '';
    position: absolute;
    width: 15px;
    height: 13px;
    background:
        radial-gradient(circle at 65% 35%, rgba(255, 255, 255, 0.4) 0%, transparent 7px),
        linear-gradient(235deg, #9C27B0, #CE93D8);
    border-radius: 60% 60% 60% 25%;
    right: -8px;
    top: 2px;
    animation: env-wing-flutter-right 0.16s ease-in-out infinite alternate;
}

@keyframes env-butterfly-path-1 {
    0%, 100% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
    15% { transform: translate(40px, -55px) rotate(18deg); }
    30% { transform: translate(80px, -30px) rotate(-12deg); }
    45% { transform: translate(60px, -75px) rotate(22deg); }
    60% { transform: translate(30px, -50px) rotate(-16deg); }
    75% { transform: translate(70px, -65px) rotate(14deg); }
    90% { transform: translate(20px, -45px) rotate(-10deg); }
}

@keyframes env-butterfly-path-2 {
    0%, 100% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
    20% { transform: translate(-50px, -45px) rotate(-15deg); }
    40% { transform: translate(-100px, -70px) rotate(20deg); }
    60% { transform: translate(-140px, -50px) rotate(-18deg); }
    80% { transform: translate(-80px, -80px) rotate(12deg); }
}

@keyframes env-butterfly-path-3 {
    0%, 100% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
    25% { transform: translate(-35px, 40px) rotate(16deg); }
    50% { transform: translate(-65px, -25px) rotate(-20deg); }
    75% { transform: translate(-40px, 15px) rotate(14deg); }
}

@keyframes env-wing-flutter-left {
    0% { transform: rotateY(0deg); }
    100% { transform: rotateY(75deg); }
}

@keyframes env-wing-flutter-right {
    0% { transform: rotateY(0deg); }
    100% { transform: rotateY(-75deg); }
}

/* === SUN RAYS === */
.theme-environment .elem-4 {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: 8;
    pointer-events: none;
}

.theme-environment .elem-4::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background:
        linear-gradient(115deg,
            transparent 0%,
            transparent 42%,
            rgba(255, 235, 59, 0.12) 43%,
            rgba(255, 235, 59, 0.22) 45%,
            rgba(255, 235, 59, 0.12) 47%,
            transparent 48%),
        linear-gradient(125deg,
            transparent 0%,
            transparent 48%,
            rgba(255, 235, 59, 0.14) 49%,
            rgba(255, 235, 59, 0.25) 51%,
            rgba(255, 235, 59, 0.14) 53%,
            transparent 54%),
        linear-gradient(135deg,
            transparent 0%,
            transparent 54%,
            rgba(255, 235, 59, 0.11) 55%,
            rgba(255, 235, 59, 0.20) 57%,
            rgba(255, 235, 59, 0.11) 59%,
            transparent 60%),
        linear-gradient(145deg,
            transparent 0%,
            transparent 60%,
            rgba(255, 235, 59, 0.13) 61%,
            rgba(255, 235, 59, 0.23) 63%,
            rgba(255, 235, 59, 0.13) 65%,
            transparent 66%);
    animation: env-rays-shimmer 32s ease-in-out infinite;
}

@keyframes env-rays-shimmer {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 0.8; }
}

/* === RAIN DROPS === */
.theme-environment .elem-5 {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: 25;
    pointer-events: none;
    opacity: 0.7;
}

.theme-environment .elem-5::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background:
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.6) 2%, transparent 10%) 6% 0% / 2px 50px,
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.55) 2%, transparent 10%) 14% 5% / 1.8px 45px,
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.65) 2%, transparent 10%) 22% 2% / 2.2px 55px,
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.5) 2%, transparent 10%) 32% 8% / 1.7px 42px,
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.6) 2%, transparent 10%) 42% 3% / 2px 48px,
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.55) 2%, transparent 10%) 52% 7% / 1.9px 46px,
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.6) 2%, transparent 10%) 62% 1% / 2px 52px,
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.5) 2%, transparent 10%) 72% 6% / 1.8px 44px,
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.65) 2%, transparent 10%) 82% 4% / 2.1px 56px,
        linear-gradient(180deg, transparent 0%, rgba(129, 212, 250, 0.55) 2%, transparent 10%) 92% 9% / 1.9px 47px;
    background-repeat: repeat-y;
    animation: env-rain-fall 1.3s linear infinite;
}

@keyframes env-rain-fall {
    0% { transform: translateY(-50px); }
    100% { transform: translateY(100vh); }
}

/* === FLOWERS === */
.theme-environment .flowers {
    position: absolute;
    bottom: 8%;
    left: 0;
    width: 100%;
    height: 15%;
    z-index: 11;
    pointer-events: none;
}

.theme-environment .flowers::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background:
        /* Flower 1 */
        radial-gradient(circle at 18% 50%, #FFEB3B 15%, transparent 16%) 0 0 / 100% 100%,
        radial-gradient(circle at 18% 35%, #FF5722 18%, #FF5722 35%, transparent 36%) 0 0 / 100% 100%,
        radial-gradient(circle at 24% 43%, #FF5722 18%, #FF5722 35%, transparent 36%) 0 0 / 100% 100%,
        radial-gradient(circle at 12% 43%, #FF5722 18%, #FF5722 35%, transparent 36%) 0 0 / 100% 100%,
        radial-gradient(circle at 18% 60%, #FF5722 18%, #FF5722 35%, transparent 36%) 0 0 / 100% 100%,
        radial-gradient(circle at 18% 48%, #FF5722 18%, #FF5722 35%, transparent 36%) 0 0 / 100% 100%,
        /* Flower 2 */
        radial-gradient(circle at 58% 45%, #FFC107 14%, transparent 15%) 0 0 / 100% 100%,
        radial-gradient(circle at 58% 30%, #9C27B0 16%, #9C27B0 32%, transparent 33%) 0 0 / 100% 100%,
        radial-gradient(circle at 64% 38%, #9C27B0 16%, #9C27B0 32%, transparent 33%) 0 0 / 100% 100%,
        radial-gradient(circle at 52% 38%, #9C27B0 16%, #9C27B0 32%, transparent 33%) 0 0 / 100% 100%,
        radial-gradient(circle at 58% 55%, #9C27B0 16%, #9C27B0 32%, transparent 33%) 0 0 / 100% 100%,
        radial-gradient(circle at 58% 43%, #9C27B0 16%, #9C27B0 32%, transparent 33%) 0 0 / 100% 100%,
        /* Flower 3 */
        radial-gradient(circle at 85% 48%, #FFEB3B 13%, transparent 14%) 0 0 / 100% 100%,
        radial-gradient(circle at 85% 34%, #E91E63 17%, #E91E63 34%, transparent 35%) 0 0 / 100% 100%,
        radial-gradient(circle at 91% 42%, #E91E63 17%, #E91E63 34%, transparent 35%) 0 0 / 100% 100%,
        radial-gradient(circle at 79% 42%, #E91E63 17%, #E91E63 34%, transparent 35%) 0 0 / 100% 100%,
        radial-gradient(circle at 85% 58%, #E91E63 17%, #E91E63 34%, transparent 35%) 0 0 / 100% 100%,
        radial-gradient(circle at 85% 46%, #E91E63 17%, #E91E63 34%, transparent 35%) 0 0 / 100% 100%;
    filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
    animation: env-flowers-sway 5.8s ease-in-out infinite;
}

@keyframes env-flowers-sway {
    0%, 100% { transform: rotate(0deg) scale(1); }
    25% { transform: rotate(2deg) scale(1.02); }
    50% { transform: rotate(0deg) scale(1.04); }
    75% { transform: rotate(-2deg) scale(1.02); }
}

/* === ATMOSPHERIC PARTICLES === */
.theme-environment .scene-particles {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 22;
    background:
        radial-gradient(circle at 12% 18%, rgba(255, 255, 102, 0.85) 0%, transparent 2px),
        radial-gradient(circle at 26% 45%, rgba(255, 255, 102, 0.9) 0%, transparent 2.2px),
        radial-gradient(circle at 38% 28%, rgba(255, 255, 102, 0.8) 0%, transparent 1.9px),
        radial-gradient(circle at 52% 62%, rgba(255, 255, 102, 0.9) 0%, transparent 2.1px),
        radial-gradient(circle at 65% 35%, rgba(255, 255, 102, 0.85) 0%, transparent 2px),
        radial-gradient(circle at 78% 58%, rgba(255, 255, 102, 0.8) 0%, transparent 2.3px),
        radial-gradient(circle at 88% 25%, rgba(255, 255, 102, 0.9) 0%, transparent 1.8px),
        radial-gradient(circle at 15% 72%, rgba(255, 255, 102, 0.85) 0%, transparent 2.1px),
        radial-gradient(circle at 42% 88%, rgba(255, 255, 102, 0.8) 0%, transparent 2px),
        radial-gradient(circle at 72% 82%, rgba(255, 255, 102, 0.9) 0%, transparent 2.2px);
    animation: env-fireflies-glow 5.5s ease-in-out infinite;
}

@keyframes env-fireflies-glow {
    0%, 100% { opacity: 0.3; transform: translate(0, 0); }
    25% { opacity: 0.8; transform: translate(8px, -12px); }
    50% { opacity: 1; transform: translate(-5px, 8px); }
    75% { opacity: 0.6; transform: translate(10px, -6px); }
}

/* === MASCOT ANIMATIONS === */

/* Happy - Nature bloom */
.theme-environment .worm-character.happy,
.theme-environment .bunny-character.happy,
.theme-environment .owl-character.happy,
.theme-environment .cat-character.happy,
.theme-environment .robot-character.happy {
    animation: env-happy-bloom 2.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes env-happy-bloom {
    0% { transform: scale(1) rotate(0deg); filter: brightness(1) saturate(1); }
    20% { transform: scale(1.12) rotate(-12deg); filter: brightness(1.15) saturate(1.2); }
    40% { transform: scale(1.25) rotate(10deg) translateY(-28px); filter: brightness(1.25) saturate(1.4); }
    60% { transform: scale(1.15) rotate(-6deg) translateY(-18px); filter: brightness(1.2) saturate(1.3); }
    80% { transform: scale(1.08) rotate(3deg) translateY(-8px); }
    100% { transform: scale(1) rotate(0deg) translateY(0); filter: brightness(1) saturate(1); }
}

/* Sad - Wilting */
.theme-environment .worm-character.sad,
.theme-environment .bunny-character.sad,
.theme-environment .owl-character.sad,
.theme-environment .cat-character.sad,
.theme-environment .robot-character.sad {
    animation: env-sad-wilt 2.6s ease-out forwards;
}

@keyframes env-sad-wilt {
    0% { transform: scale(1) rotate(0deg); filter: brightness(1) saturate(1); }
    30% { transform: scale(0.94) rotate(-7deg) translateY(10px); filter: brightness(0.85) saturate(0.7); }
    60% { transform: scale(0.86) rotate(4deg) translateY(18px); filter: brightness(0.65) saturate(0.4) sepia(0.25); }
    100% { transform: scale(0.80) rotate(-3deg) translateY(25px); filter: brightness(0.55) saturate(0.25) sepia(0.35); }
}

/* Excited - Leaf dance */
.theme-environment .bunny-character.excited,
.theme-environment .worm-character.excited {
    animation: env-excited-dance 1.9s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes env-excited-dance {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    15% { transform: translateY(-32px) rotate(18deg); }
    30% { transform: translateY(-20px) rotate(-22deg); }
    45% { transform: translateY(-38px) rotate(14deg); }
    60% { transform: translateY(-25px) rotate(-18deg); }
    75% { transform: translateY(-15px) rotate(8deg); }
}
