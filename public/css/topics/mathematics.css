/* ============================================
   MATHEMATICS THEME - PREMIUM CINEMATIC
   Abstract mathematical wonderland
   Purple/pink palette with geometric elegance
   ============================================ */

/* === LAYERED CHALKBOARD BACKGROUND === */
.theme-mathematics .scene-background {
    background:
        /* Top ethereal glow */
        radial-gradient(ellipse 850px 420px at 50% 0%, rgba(156, 39, 176, 0.12) 0%, transparent 50%),
        /* Geometric glow spots */
        radial-gradient(ellipse 580px 580px at 18% 40%, rgba(236, 64, 122, 0.1) 0%, transparent 55%),
        radial-gradient(ellipse 620px 620px at 82% 58%, rgba(103, 58, 183, 0.12) 0%, transparent 60%),
        radial-gradient(ellipse 480px 480px at 50% 78%, rgba(156, 39, 176, 0.08) 0%, transparent 50%),
        /* Academic gradient */
        linear-gradient(180deg,
            #1a1625 0%,
            #221c30 12%,
            #2a233c 24%,
            #332a48 36%,
            #3d3154 48%,
            #473860 60%,
            #52406d 72%,
            #5d497a 84%,
            #695287 96%,
            #755b94 100%);
    overflow: hidden;
    position: relative;
}

/* === GRAPH PAPER GRID === */
.theme-mathematics .scene-background::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background-image:
        /* Major grid lines */
        repeating-linear-gradient(0deg, transparent 0px, transparent 49px, rgba(236, 64, 122, 0.15) 49px, rgba(236, 64, 122, 0.15) 51px),
        repeating-linear-gradient(90deg, transparent 0px, transparent 49px, rgba(156, 39, 176, 0.15) 49px, rgba(156, 39, 176, 0.15) 51px),
        /* Minor grid lines */
        repeating-linear-gradient(0deg, transparent 0px, transparent 24px, rgba(255, 255, 255, 0.05) 24px, rgba(255, 255, 255, 0.05) 25px),
        repeating-linear-gradient(90deg, transparent 0px, transparent 24px, rgba(255, 255, 255, 0.05) 24px, rgba(255, 255, 255, 0.05) 25px);
    background-size: 50px 50px, 50px 50px, 25px 25px, 25px 25px;
    opacity: 0.4;
    animation: math-grid-drift 45s linear infinite;
    pointer-events: none;
    z-index: 1;
}

@keyframes math-grid-drift {
    0% { transform: translate(0, 0); }
    100% { transform: translate(50px, 50px); }
}

/* === FLOATING SYMBOL PARTICLES === */
.theme-mathematics .symbol-particles {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 15;
    font-family: 'Times New Roman', serif;
    font-size: 28px;
    color: rgba(236, 64, 122, 0.4);
    text-shadow: 0 0 15px rgba(236, 64, 122, 0.6);
}

.theme-mathematics .symbol-particles::before {
    content: 'π ∞ Σ';
    position: absolute;
    top: 22%;
    left: 18%;
    letter-spacing: 25px;
    animation: math-symbol-float-1 14s ease-in-out infinite;
}

.theme-mathematics .symbol-particles::after {
    content: '∫ √ Δ';
    position: absolute;
    top: 65%;
    left: 70%;
    letter-spacing: 20px;
    color: rgba(156, 39, 176, 0.35);
    text-shadow: 0 0 15px rgba(156, 39, 176, 0.5);
    animation: math-symbol-float-2 16s ease-in-out infinite 3s;
}

@keyframes math-symbol-float-1 {
    0%, 100% {
        transform: translateY(0) translateX(0) rotate(0deg);
        opacity: 0.4;
    }
    50% {
        transform: translateY(-30px) translateX(15px) rotate(10deg);
        opacity: 0.7;
    }
}

@keyframes math-symbol-float-2 {
    0%, 100% {
        transform: translateY(0) translateX(0) rotate(0deg);
        opacity: 0.35;
    }
    50% {
        transform: translateY(-25px) translateX(-12px) rotate(-8deg);
        opacity: 0.65;
    }
}

/* === ELEMENT 1: PI SYMBOL === */
.theme-mathematics .elem-1 {
    position: absolute;
    top: 15%;
    left: 12%;
    width: 70px;
    height: 80px;
    z-index: 12;
    animation: math-pi-float 9.5s ease-in-out infinite;
    filter: drop-shadow(0 5px 18px rgba(156, 39, 176, 0.5));
    pointer-events: none;
}

/* Pi top bar */
.theme-mathematics .elem-1::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 10px;
    top: 18px;
    background:
        /* Highlight */
        linear-gradient(90deg,
            transparent 0%,
            rgba(255, 255, 255, 0.2) 20%,
            rgba(255, 255, 255, 0.1) 50%,
            transparent 100%),
        /* Main gradient */
        linear-gradient(90deg,
            transparent 0%,
            #E040FB 8%,
            #D500F9 50%,
            #AA00FF 92%,
            transparent 100%);
    border-radius: 5px 5px 0 0;
    box-shadow:
        0 0 25px rgba(224, 64, 251, 0.6),
        inset 0 -2px 8px rgba(0, 0, 0, 0.2);
}

/* Pi legs */
.theme-mathematics .elem-1::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background:
        /* Left leg */
        linear-gradient(180deg,
            rgba(224, 64, 251, 0) 0%,
            rgba(224, 64, 251, 1) 35%,
            rgba(213, 0, 249, 1) 60%,
            rgba(170, 0, 255, 1) 100%) 18% 30% / 22% 70% no-repeat,
        /* Right leg */
        linear-gradient(180deg,
            rgba(224, 64, 251, 0) 0%,
            rgba(224, 64, 251, 1) 35%,
            rgba(213, 0, 249, 1) 60%,
            rgba(170, 0, 255, 1) 100%) 60% 30% / 22% 70% no-repeat;
    box-shadow:
        0 0 30px rgba(224, 64, 251, 0.5);
    animation: math-pi-glow 3.8s ease-in-out infinite;
}

@keyframes math-pi-float {
    0%, 100% { transform: translateY(0) rotate(-3deg) scale(1); }
    33% { transform: translateY(-15px) rotate(4deg) scale(1.05); }
    66% { transform: translateY(-8px) rotate(-5deg) scale(1.03); }
}

@keyframes math-pi-glow {
    0%, 100% {
        filter: brightness(1) drop-shadow(0 0 20px rgba(224, 64, 251, 0.5));
    }
    50% {
        filter: brightness(1.3) drop-shadow(0 0 35px rgba(224, 64, 251, 0.8));
    }
}

/* === ELEMENT 2: ROTATING CUBE === */
.theme-mathematics .elem-2 {
    position: absolute;
    top: 18%;
    right: 15%;
    width: 90px;
    height: 90px;
    z-index: 13;
    perspective: 800px;
    animation: math-cube-hover 10.5s ease-in-out infinite;
    pointer-events: none;
}

/* Cube face */
.theme-mathematics .elem-2::before {
    content: '';
    position: absolute;
    width: 65px;
    height: 65px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) rotateX(30deg) rotateY(45deg);
    background:
        /* Grid lines */
        linear-gradient(90deg, transparent 31%, rgba(255, 255, 255, 0.3) 32%, rgba(255, 255, 255, 0.3) 34%, transparent 35%),
        linear-gradient(90deg, transparent 64%, rgba(255, 255, 255, 0.3) 65%, rgba(255, 255, 255, 0.3) 67%, transparent 68%),
        linear-gradient(0deg, transparent 31%, rgba(255, 255, 255, 0.3) 32%, rgba(255, 255, 255, 0.3) 34%, transparent 35%),
        linear-gradient(0deg, transparent 64%, rgba(255, 255, 255, 0.3) 65%, rgba(255, 255, 255, 0.3) 67%, transparent 68%),
        /* Face gradient */
        linear-gradient(135deg,
            rgba(103, 58, 183, 0.7) 0%,
            rgba(156, 39, 176, 0.8) 50%,
            rgba(103, 58, 183, 0.7) 100%);
    border: 2px solid rgba(186, 104, 200, 0.8);
    box-shadow:
        0 0 30px rgba(156, 39, 176, 0.5),
        inset 0 0 25px rgba(255, 255, 255, 0.1);
    animation: math-cube-spin 8s linear infinite;
}

/* Triangle overlay */
.theme-mathematics .elem-2::after {
    content: '';
    position: absolute;
    width: 0;
    height: 0;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border-left: 32px solid transparent;
    border-right: 32px solid transparent;
    border-bottom: 55px solid rgba(236, 64, 122, 0.6);
    filter: drop-shadow(0 0 18px rgba(236, 64, 122, 0.7));
    animation: math-triangle-pulse 4.5s ease-in-out infinite;
}

@keyframes math-cube-hover {
    0%, 100% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-18px) scale(1.08); }
}

@keyframes math-cube-spin {
    0%, 100% {
        transform: translate(-50%, -50%) rotateX(30deg) rotateY(45deg);
        opacity: 0.8;
    }
    50% {
        transform: translate(-50%, -50%) rotateX(30deg) rotateY(45deg) scale(1.1);
        opacity: 1;
    }
}

@keyframes math-triangle-pulse {
    0%, 100% {
        opacity: 0.6;
        filter: drop-shadow(0 0 18px rgba(236, 64, 122, 0.7));
    }
    50% {
        opacity: 1;
        filter: drop-shadow(0 0 30px rgba(236, 64, 122, 1));
    }
}

/* === ELEMENT 3: CALCULATOR === */
.theme-mathematics .elem-3 {
    position: absolute;
    bottom: 25%;
    right: 18%;
    width: 48px;
    height: 65px;
    z-index: 11;
    animation: math-calc-bounce 6.5s ease-in-out infinite;
    filter: drop-shadow(0 6px 15px rgba(0, 0, 0, 0.35));
    pointer-events: none;
}

/* Calculator body */
.theme-mathematics .elem-3::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background:
        /* Screen */
        linear-gradient(180deg,
            rgba(76, 175, 80, 0.9) 0%,
            rgba(56, 142, 60, 1) 100%) 6% 10% / 88% 22% no-repeat,
        /* Button grid - row 1 */
        radial-gradient(circle 4px at 20% 42%, #ECEFF1 0%, #CFD8DC 100%),
        radial-gradient(circle 4px at 42% 42%, #ECEFF1 0%, #CFD8DC 100%),
        radial-gradient(circle 4px at 64% 42%, #ECEFF1 0%, #CFD8DC 100%),
        radial-gradient(circle 4px at 86% 42%, #FFC107 0%, #FFA000 100%),
        /* Button grid - row 2 */
        radial-gradient(circle 4px at 20% 58%, #ECEFF1 0%, #CFD8DC 100%),
        radial-gradient(circle 4px at 42% 58%, #ECEFF1 0%, #CFD8DC 100%),
        radial-gradient(circle 4px at 64% 58%, #ECEFF1 0%, #CFD8DC 100%),
        radial-gradient(circle 4px at 86% 58%, #FFC107 0%, #FFA000 100%),
        /* Button grid - row 3 */
        radial-gradient(circle 4px at 20% 74%, #ECEFF1 0%, #CFD8DC 100%),
        radial-gradient(circle 4px at 42% 74%, #ECEFF1 0%, #CFD8DC 100%),
        radial-gradient(circle 4px at 64% 74%, #ECEFF1 0%, #CFD8DC 100%),
        radial-gradient(circle 4px at 86% 74%, #FFC107 0%, #FFA000 100%),
        /* Body gradient */
        linear-gradient(180deg,
            #78909C 0%,
            #607D8B 50%,
            #546E7A 100%);
    border-radius: 8px;
    border: 2px solid #90A4AE;
    box-shadow:
        inset 0 2px 6px rgba(255, 255, 255, 0.2),
        inset 0 -2px 8px rgba(0, 0, 0, 0.2),
        0 6px 18px rgba(0, 0, 0, 0.3);
}

/* Screen glow */
.theme-mathematics .elem-3::after {
    content: '';
    position: absolute;
    width: 42px;
    height: 14px;
    top: 6.5px;
    left: 3px;
    background: linear-gradient(180deg,
        rgba(76, 175, 80, 0.4) 0%,
        rgba(76, 175, 80, 0.7) 100%);
    border-radius: 2px;
    box-shadow:
        0 0 15px rgba(76, 175, 80, 0.6),
        inset 0 -2px 5px rgba(0, 0, 0, 0.2);
    animation: math-screen-flash 3.5s ease-in-out infinite;
}

@keyframes math-calc-bounce {
    0%, 100% { transform: translateY(0) scale(1); }
    15% { transform: translateY(-6px) scale(1.02); }
    30% { transform: translateY(0) scale(1); }
    45% { transform: translateY(-4px) scale(1.015); }
}

@keyframes math-screen-flash {
    0%, 88%, 100% { opacity: 1; }
    92%, 96% { opacity: 0.7; }
}

/* === ELEMENT 4: INFINITY SYMBOL === */
.theme-mathematics .elem-4 {
    position: absolute;
    bottom: 35%;
    left: 28%;
    width: 95px;
    height: 45px;
    z-index: 10;
    animation: math-infinity-morph 11.5s ease-in-out infinite;
    pointer-events: none;
}

/* Left loop */
.theme-mathematics .elem-4::before {
    content: '';
    position: absolute;
    width: 40px;
    height: 40px;
    top: 2.5px;
    left: 0;
    border: 5px solid transparent;
    border-image: linear-gradient(135deg,
        #FF9800 0%,
        #FF6F00 50%,
        #E65100 100%) 1;
    border-radius: 50%;
    box-shadow:
        0 0 20px rgba(255, 152, 0, 0.6),
        inset 0 0 15px rgba(255, 152, 0, 0.3);
    animation: math-loop-left 6.5s ease-in-out infinite;
}

/* Right loop */
.theme-mathematics .elem-4::after {
    content: '';
    position: absolute;
    width: 40px;
    height: 40px;
    top: 2.5px;
    right: 0;
    border: 5px solid transparent;
    border-image: linear-gradient(135deg,
        #FF9800 0%,
        #FF6F00 50%,
        #E65100 100%) 1;
    border-radius: 50%;
    box-shadow:
        0 0 20px rgba(255, 152, 0, 0.6),
        inset 0 0 15px rgba(255, 152, 0, 0.3);
    animation: math-loop-right 6.5s ease-in-out infinite;
}

@keyframes math-infinity-morph {
    0%, 100% { transform: scaleX(1) translateY(0); }
    50% { transform: scaleX(1.2) translateY(-10px); }
}

@keyframes math-loop-left {
    0%, 100% {
        transform: rotate(0deg) scale(1);
        box-shadow:
            0 0 20px rgba(255, 152, 0, 0.6),
            inset 0 0 15px rgba(255, 152, 0, 0.3);
    }
    50% {
        transform: rotate(-12deg) scale(1.1);
        box-shadow:
            0 0 35px rgba(255, 152, 0, 0.9),
            inset 0 0 20px rgba(255, 152, 0, 0.5);
    }
}

@keyframes math-loop-right {
    0%, 100% {
        transform: rotate(0deg) scale(1);
        box-shadow:
            0 0 20px rgba(255, 152, 0, 0.6),
            inset 0 0 15px rgba(255, 152, 0, 0.3);
    }
    50% {
        transform: rotate(12deg) scale(1.1);
        box-shadow:
            0 0 35px rgba(255, 152, 0, 0.9),
            inset 0 0 20px rgba(255, 152, 0, 0.5);
    }
}

/* === ELEMENT 5: NUMBER CASCADE === */
.theme-mathematics .elem-5 {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 14;
    font-family: 'Courier New', monospace;
    font-size: 32px;
    font-weight: bold;
}

.theme-mathematics .elem-5::before {
    content: '1 3 5 7';
    position: absolute;
    top: 35%;
    right: 30%;
    color: rgba(156, 39, 176, 0.5);
    text-shadow: 0 0 12px rgba(156, 39, 176, 0.8);
    letter-spacing: 12px;
    animation: math-numbers-glow-1 5.5s ease-in-out infinite;
}

.theme-mathematics .elem-5::after {
    content: '2 4 6 8';
    position: absolute;
    top: 30%;
    right: 32%;
    color: rgba(236, 64, 122, 0.45);
    text-shadow: 0 0 12px rgba(236, 64, 122, 0.7);
    letter-spacing: 12px;
    animation: math-numbers-glow-2 6.5s ease-in-out infinite 2s;
}

@keyframes math-numbers-glow-1 {
    0%, 100% {
        opacity: 0.5;
        transform: translateY(0) scale(1);
        text-shadow: 0 0 12px rgba(156, 39, 176, 0.8);
    }
    50% {
        opacity: 1;
        transform: translateY(-10px) scale(1.08);
        text-shadow:
            0 0 20px rgba(156, 39, 176, 1),
            0 0 40px rgba(103, 58, 183, 0.6);
    }
}

@keyframes math-numbers-glow-2 {
    0%, 100% {
        opacity: 0.45;
        transform: translateY(0) scale(1);
        text-shadow: 0 0 12px rgba(236, 64, 122, 0.7);
    }
    50% {
        opacity: 0.95;
        transform: translateY(-8px) scale(1.06);
        text-shadow:
            0 0 18px rgba(236, 64, 122, 0.95),
            0 0 35px rgba(233, 30, 99, 0.5);
    }
}

/* === GEOMETRIC PARTICLE STREAM === */
.theme-mathematics .geometric-particles {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 4;
}

.theme-mathematics .geometric-particles::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background:
        /* Purple particles */
        radial-gradient(circle 3px at 22% 28%, rgba(156, 39, 176, 0.7) 0%, rgba(156, 39, 176, 0.7) 70%, transparent 100%),
        radial-gradient(circle 2.5px at 45% 18%, rgba(186, 104, 200, 0.6) 0%, rgba(186, 104, 200, 0.6) 70%, transparent 100%),
        radial-gradient(circle 3.5px at 68% 35%, rgba(156, 39, 176, 0.65) 0%, rgba(156, 39, 176, 0.65) 70%, transparent 100%),
        /* Pink particles */
        radial-gradient(circle 2.5px at 15% 55%, rgba(236, 64, 122, 0.7) 0%, rgba(236, 64, 122, 0.7) 70%, transparent 100%),
        radial-gradient(circle 3px at 38% 65%, rgba(233, 30, 99, 0.65) 0%, rgba(233, 30, 99, 0.65) 70%, transparent 100%),
        radial-gradient(circle 2px at 62% 72%, rgba(236, 64, 122, 0.6) 0%, rgba(236, 64, 122, 0.6) 70%, transparent 100%),
        /* Orange particles */
        radial-gradient(circle 2.5px at 88% 48%, rgba(255, 152, 0, 0.7) 0%, rgba(255, 152, 0, 0.7) 70%, transparent 100%),
        radial-gradient(circle 3px at 12% 82%, rgba(255, 193, 7, 0.65) 0%, rgba(255, 193, 7, 0.65) 70%, transparent 100%);
    animation: math-particle-drift 17s ease-in-out infinite;
}

@keyframes math-particle-drift {
    0%, 100% {
        transform: translate(0, 0) scale(1);
        opacity: 0.6;
    }
    33% {
        transform: translate(10px, -28px) scale(1.15);
        opacity: 0.9;
    }
    66% {
        transform: translate(-8px, -35px) scale(1.08);
        opacity: 0.8;
    }
}

/* === AMBIENT EQUATION FIELD === */
.theme-mathematics .equation-field {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 42%;
    pointer-events: none;
    z-index: 2;
    background:
        radial-gradient(ellipse 720px 380px at 22% 100%, rgba(156, 39, 176, 0.14) 0%, transparent 58%),
        radial-gradient(ellipse 680px 420px at 52% 100%, rgba(236, 64, 122, 0.16) 0%, transparent 62%),
        radial-gradient(ellipse 640px 380px at 78% 100%, rgba(103, 58, 183, 0.12) 0%, transparent 55%);
    animation: math-field-pulse 14s ease-in-out infinite;
}

@keyframes math-field-pulse {
    0%, 100% {
        opacity: 0.55;
        transform: scaleY(1);
    }
    50% {
        opacity: 0.82;
        transform: scaleY(1.18);
    }
}

/* === MASCOT ANIMATIONS === */
.theme-mathematics .worm-character.happy,
.theme-mathematics .bunny-character.happy,
.theme-mathematics .owl-character.happy,
.theme-mathematics .cat-character.happy,
.theme-mathematics .robot-character.happy {
    animation: math-happy-solved 2.6s ease-out;
}

@keyframes math-happy-solved {
    0% { transform: scale(1) translateY(0) rotate(0deg); }
    12% { transform: scale(0.96) translateY(4px) rotate(-2deg); }
    24% { transform: scale(1.15) translateY(-22px) rotate(8deg); }
    36% { transform: scale(1.26) translateY(-38px) rotate(-10deg); }
    48% { transform: scale(1.3) translateY(-42px) rotate(12deg); }
    60% { transform: scale(1.22) translateY(-32px) rotate(-6deg); }
    72% { transform: scale(1.12) translateY(-20px) rotate(4deg); }
    84% { transform: scale(1.06) translateY(-10px) rotate(-2deg); }
    100% { transform: scale(1) translateY(0) rotate(0deg); }
}

.theme-mathematics .robot-character.excited,
.theme-mathematics .owl-character.excited {
    animation: math-breakthrough 2.2s ease-out;
}

@keyframes math-breakthrough {
    0%, 100% {
        transform: translateY(0) scale(1);
        filter: brightness(1) drop-shadow(0 5px 12px rgba(156, 39, 176, 0.4));
    }
    30% {
        transform: translateY(-32px) scale(1.28);
        filter: brightness(1.5) drop-shadow(0 16px 32px rgba(224, 64, 251, 0.9));
    }
    60% {
        transform: translateY(-22px) scale(1.16) rotate(14deg);
        filter: brightness(1.35) drop-shadow(0 12px 24px rgba(236, 64, 122, 0.7));
    }
}

.theme-mathematics .worm-character.sad,
.theme-mathematics .bunny-character.sad,
.theme-mathematics .owl-character.sad,
.theme-mathematics .cat-character.sad,
.theme-mathematics .robot-character.sad {
    animation: math-sad-error 2.4s ease-out forwards;
}

@keyframes math-sad-error {
    0% {
        transform: scale(1) translateY(0);
        filter: brightness(1) saturate(1);
    }
    22% {
        transform: scale(0.96) translateY(4px) translateX(-4px);
        filter: brightness(0.9) saturate(0.8);
    }
    44% {
        transform: scale(0.9) translateY(10px) translateX(5px);
        filter: brightness(0.75) saturate(0.5);
    }
    66% {
        transform: scale(0.86) translateY(15px) translateX(-3px);
        filter: brightness(0.62) saturate(0.35);
    }
    100% {
        transform: scale(0.82) translateY(20px);
        filter: brightness(0.52) saturate(0.25) hue-rotate(30deg);
    }
}

.theme-mathematics .robot-character.idle {
    animation: math-robot-compute 4s ease-in-out infinite;
}

@keyframes math-robot-compute {
    0%, 100% {
        filter: hue-rotate(0deg) drop-shadow(0 5px 10px rgba(156, 39, 176, 0.4)) brightness(1);
    }
    50% {
        filter: hue-rotate(25deg) drop-shadow(0 8px 20px rgba(236, 64, 122, 0.6)) brightness(1.18);
    }
}
